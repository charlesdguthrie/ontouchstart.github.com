<html>
<head>
<meta name="viewport" content="width=device-width" />
<title>JSNotes</title>
<style>
pre {
  width: 90%;
  margin: 1em;
  padding: 1em;
  border: 1px solid black;
  -webkit-transition-duration: 1000ms;
}
</style>
<script>
window.addEventListener('load', function () {
  var codeArray = document.getElementsByTagName('pre');
  function loadCode(i) {
    var code = codeArray[i];
    var js = document.createElement('script');
    js.innerText = code.innerText;

    code.style.webkitTransitionDelay = i * 100 + 'ms';
    code.style.padding = '0';
    code.style.width = '0';
    code.style.height = '0';
    
    code.style.overflow = 'hidden';

    code.addEventListener('webkitTransitionEnd', function () {
      code.ontouchstart = null;
      code.style.display = 'none';
      document.body.appendChild(js);
    });
  }
  
  function code(i) {
    return function () {
      for( var j = 0; j <= i; j++) {
        loadCode(j);
      }
    };
  }

  for (var i = 0; i < codeArray.length; i++) {
    codeArray[i].ontouchstart = code(i);
  }
});
</script>
</head>
<body>
<pre>
function css(rule) {
  document.styleSheets[0].insertRule(rule);
}
</pre>
<pre>
function el(parent, tag, html) {
  var element = document.createElement(tag);
  if(html) element.innerHTML = html;
  parent.appendChild(element);
  return element;
}
</pre>
<pre>
function loadJS(src, cbk, err) {
  var js = document.createElement('script');
  js.src = src;
  js.onload = cbk;
  js.onerror = err;
  document.body.appendChild(js);
  return js;
}
</pre>
<pre>
var results;
function twitterTestCallback (data) {
  results = data.results;
}
</pre>
<pre>
function twitterList () {
  var list = el(document.body, 'ol');
  for(var i in results) {
    var result = results[i];
    var li = el(list, 'li');
    var item = el(li, 'div');
    item.style.margin = '2em';
    el(item, 'img').src = result.profile_image_url;
    el(item, 'span', result.from_user);
    el(item, 'div', result.text);
  }
}
</pre>
<pre>
function twitterTest() {
  var api = 'http://search.twitter.com/search.json?';
  var q = 'q=iPhone%204S';
  var include_entities = '&include_entities=true';
  var with_twitter_user_id = '&with_twitter_user_id=true';
  var result_type = '&result_type=mixed';

  var cb = '&callback=twitterTestCallback';
  var url = api + q + include_entities + with_twitter_user_id + result_type + cb;
  loadJS(url, twitterList, null);
}
</pre>
<pre>
twitterTest();
</pre>
</body>
</html>
