<html>
<head>
<meta name="viewport" content="width=device-width" />
<title>JSNotes</title>
<style>
pre {
  margin: 1em;
  padding: 1em;
  border: 1px solid black;
}

pre.done {
  display: none;
}
</style>
<script>
function load(e) {
  var js = document.createElement('script');
  js.innerText = e.target.innerText;
  document.head.appendChild(js);
  e.target.className = 'done';
  e.target.onclick = null;
}

window.addEventListener('load', function () {
  var codeArray = document.getElementsByTagName('pre');
  for (var i = 0; i < codeArray.length; i++) {
    codeArray[i].onclick = load;  
  }
});
</script>
</head>
<body>
<pre>
function loadJS(src, cbk, err) {
  var js = document.createElement('script');
  js.src = src;
  js.onload = cbk;
  js.onerror = err;
  document.head.appendChild(js);
  return js;
}
</pre>
<pre>
function gmap(center, w, h, markers) {
  var api = 'https://maps.googleapis.com/maps/api/js?sensor=false';
  var container = document.createElement('div');
  container.style.width = w + "px";
  container.style.height = h + "px";

  function map (container) {
    var latLng = new google.maps.LatLng(center[0], center[1]);
    var options = {
      zoom: 13,
      center: latLng,
      disableDefaultUI: true,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    var m = new google.maps.Map(container, options);
    var markerArray = [];
    markerArray.push(new google.maps.Marker({
      position: latLng, 
      title:"Times Square"
    }));   

    for(var i = 0; i < markers.length; i++) { 
      var markerLatLng = new google.maps.LatLng(markers[i][0], markers[i][1]);
      markerArray.push(new google.maps.Marker({position: markerLatLng}));
    }
    for(var i = 0; i < markerArray.length; i++) {
      markerArray[i].setMap(m); 
    }
  }

  window.gmap.draw = function () {
     map(container);
     document.body.appendChild(container);
  };

  loadJS(api + '&callback=gmap.draw', null, null);
  return container;
}
</pre>
<pre>
function geo(cbk) {
  function success (data) {
    window.geoCenter = [data.coords.latitude, data.coords.longitude];
    geoLocation2x2();
  }

  function error() {
    console.log('geo error');
  }

  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(success, error);
  }
}
</pre>
<pre>
function geoLocation2x2() {
  var lat = window.geoCenter[0];
  var lng = window.geoCenter[1];
  document.title = "Location (" + lat + ", " + lng + ")";
  var markers = [];
  for( i = -1; i < 2; i++) {
    for( j = -1; j < 2; j++) {
      markers.push([lat + (i / 69), lng + (j / 53)]);
    }
  }

  var map = gmap(window.geoCenter, 320, 320, markers);
  map.style.margin = 'auto';
} 
</pre>
<pre>
geo();
</pre>
</body>
</html>
