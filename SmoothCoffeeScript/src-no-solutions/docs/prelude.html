<!DOCTYPE html>  <html> <head>   <title>prelude.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="00-Foreword.html">                 00-Foreword.coffee               </a>                                           <a class="source" href="01-Introduction.html">                 01-Introduction.coffee               </a>                                           <a class="source" href="02-BasicCoffeeScript.html">                 02-BasicCoffeeScript.coffee               </a>                                           <a class="source" href="03-Functions.html">                 03-Functions.coffee               </a>                                           <a class="source" href="04-DataStructures.html">                 04-DataStructures.coffee               </a>                                           <a class="source" href="04-emails.html">                 04-emails.coffee               </a>                                           <a class="source" href="05-ErrorHandling.html">                 05-ErrorHandling.coffee               </a>                                           <a class="source" href="06-FunctionalProgramming.html">                 06-FunctionalProgramming.coffee               </a>                                           <a class="source" href="07-Searching.html">                 07-Searching.coffee               </a>                                           <a class="source" href="08-ObjectOrientation.html">                 08-ObjectOrientation.coffee               </a>                                           <a class="source" href="09-RegularExpressions.html">                 09-RegularExpressions.coffee               </a>                                           <a class="source" href="10-Circular.html">                 10-Circular.coffee               </a>                                           <a class="source" href="10-CircularTest.html">                 10-CircularTest.coffee               </a>                                           <a class="source" href="10-MathFix.html">                 10-MathFix.coffee               </a>                                           <a class="source" href="10-Modularity.html">                 10-Modularity.coffee               </a>                                           <a class="source" href="10-SeedLife.html">                 10-SeedLife.coffee               </a>                                           <a class="source" href="10-TestWebSockets.html">                 10-TestWebSockets.coffee               </a>                                           <a class="source" href="10-WebSocketLife.html">                 10-WebSocketLife.coffee               </a>                                           <a class="source" href="A1-LanguageExtras.html">                 A1-LanguageExtras.coffee               </a>                                           <a class="source" href="A2-BinaryHeap.html">                 A2-BinaryHeap.coffee               </a>                                           <a class="source" href="A2-BinaryHeapTest.html">                 A2-BinaryHeapTest.coffee               </a>                                           <a class="source" href="A3-Microbench.html">                 A3-Microbench.coffee               </a>                                           <a class="source" href="A3-Microtest.html">                 A3-Microtest.py               </a>                                           <a class="source" href="A3-Queen.html">                 A3-Queen.coffee               </a>                                           <a class="source" href="A3-Queens.html">                 A3-Queens.py               </a>                                           <a class="source" href="A4-NoSolutions.html">                 A4-NoSolutions.coffee               </a>                                           <a class="source" href="coffeekup.html">                 coffeekup.coffee               </a>                                           <a class="source" href="prelude.html">                 prelude.coffee               </a>                                           <a class="source" href="underscore.html">                 underscore.coffee               </a>                                           <a class="source" href="ws.html">                 ws.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               prelude.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Usage: require './prelude' or on commandline: coffee -r ./prelude</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>This prelude is a learning environment for 'Smooth CoffeeScript'.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude = </span><span class="p">{}</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <h2>User settings</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>By default the prelude uses the global namespace to make access
to its functions and underscore easy.</p>

<p>Set useGlobal to <code>no</code> to get only prelude defined in your namespace.</p>

<p>Setting useGlobal to <code>no</code> will make all samples fail, since all
calls to the prelude functions must be qualified with prelude.</p>

<p>Setting it to <code>no</code> can be used for your own development
where it can help avoid name-clashes with other libraries.
You can also freely copy parts of it into your own projects.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">useGlobal = </span><span class="kc">yes</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Set to <code>no</code> to get monochrome output</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">useColors = </span><span class="kc">yes</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>On Windows add your browser here if it is not listed.
Edit path to Google Chrome if that is your browser.
See below to enable WebSockets in Firefox or Opera.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">windowsBrowsers = </span><span class="p">[</span>
  <span class="s2">&quot;C:\\Users\\USERNAME\\AppData\\Local\\Google\\Chrome\\Application\\chrome.exe&quot;</span>
  <span class="s2">&quot;C:\\Program Files\\Safari\\Safari.exe&quot;</span>
  <span class="s2">&quot;C:\\Program Files\\Mozilla Firefox\\firefox.exe&quot;</span>
  <span class="s2">&quot;C:\\Program Files\\Opera\\opera.exe&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>"C:\Program Files\Internet Explorer\iexplore.exe" # IE9 known not to work</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p><em>Enabling WebSockets in Firefox 4.</em></p>

<ol>
<li><p>Type about:config in address bar and continue
by clicking "I'll be careful, I promise"</p></li>
<li><p>Set network.websocket.enabled value to true and
set network.websocket.override-security-block
preferences to true.</p></li>
<li><p>Restart Firefox browser.</p></li>
</ol>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p><em>Enabling WebSockets in Opera 11.</em></p>

<ol>
<li><p>Open Opera browser, type or paste
opera:config#Enable%20WebSockets
in the address bar and press enter.</p></li>
<li><p>Select or tick mark against
"Enable WebSockets" under User Prefs.</p></li>
</ol>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <h2>File helpers</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Test if a file exists</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude.fileExists = </span><span class="nf">(filename) -&gt;</span>
  <span class="k">try</span>
    <span class="p">(</span><span class="nx">require</span> <span class="s1">&#39;fs&#39;</span><span class="p">).</span><span class="nx">statSync</span><span class="p">(</span><span class="nx">filename</span><span class="p">).</span><span class="nx">isFile</span><span class="p">()</span>
  <span class="k">catch</span> <span class="nx">error</span>
    <span class="k">return</span> <span class="kc">false</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Return contents of filename as UTF-8 text</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude.readTextFile = </span><span class="nf">(filename) -&gt;</span>
  <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">).</span><span class="nx">readFileSync</span> <span class="nx">filename</span><span class="p">,</span> <span class="s1">&#39;utf8&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Return contents of filename as binary buffer</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude.readBinaryFile = </span><span class="nf">(filename) -&gt;</span>
  <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">).</span><span class="nx">readFileSync</span> <span class="nx">filename</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <h2>Internal helper</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Translate a server object to a usable URL</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude.getServerURL = </span><span class="nf">(server) -&gt;</span>
  <span class="nv">address = </span><span class="nx">server</span><span class="p">.</span><span class="nx">address</span><span class="p">().</span><span class="nx">address</span>
  <span class="k">if</span> <span class="nx">address</span> <span class="o">==</span> <span class="s1">&#39;0.0.0.0&#39;</span> <span class="c1"># Windows does not like 0.0.0.0</span>
    <span class="nv">address = </span><span class="s1">&#39;127.0.0.1&#39;</span>
  <span class="s2">&quot;http://#{address}:#{server.address().port}/&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <h2>Web browser and server functions</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Open a web browser pointing to URL or a filename</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude.viewURL = </span><span class="nf">(url) -&gt;</span>
  <span class="k">switch</span> <span class="p">(</span><span class="nx">require</span> <span class="s1">&#39;os&#39;</span><span class="p">).</span><span class="nx">type</span><span class="p">()</span>
    <span class="k">when</span> <span class="s1">&#39;Darwin&#39;</span>
      <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;child_process&#39;</span><span class="p">).</span><span class="nx">exec</span> <span class="s1">&#39;open &#39;</span> <span class="o">+</span> <span class="nx">url</span>
      <span class="k">return</span>
    <span class="k">when</span> <span class="s1">&#39;Windows&#39;</span><span class="p">,</span> <span class="s1">&#39;CYGWIN_NT-6.1&#39;</span>
      <span class="k">for</span> <span class="nx">browser</span> <span class="k">in</span> <span class="nx">windowsBrowsers</span>
        <span class="k">if</span> <span class="nx">prelude</span><span class="p">.</span><span class="nx">fileExists</span> <span class="nx">browser</span>
          <span class="nx">show</span> <span class="s2">&quot;Browser: #{browser} URL: #{url}&quot;</span>
          <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;child_process&#39;</span><span class="p">).</span><span class="nx">execFile</span> <span class="nx">browser</span><span class="p">,</span> <span class="p">[</span><span class="nx">url</span><span class="p">]</span>
          <span class="nx">show</span> <span class="s2">&quot;Process launced: #{browser} #{url}&quot;</span>
          <span class="k">return</span>
    <span class="k">when</span> <span class="s1">&#39;Linux&#39;</span>
      <span class="p">;</span> <span class="c1"># Is there a simple way to do it?</span>
  <span class="nx">show</span> <span class="s1">&#39;Open a web browser at: &#39;</span> <span class="o">+</span> <span class="nx">url</span>
  <span class="k">return</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>View server instances</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude.server = </span><span class="p">[]</span>
<span class="nv">prelude.portNumber = </span><span class="mi">3456</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Start a server to view content
(a file or HTML) in a browser</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude.viewServer = </span><span class="nf">(content) -&gt;</span>
  <span class="nv">webpage =</span>
    <span class="k">if</span> <span class="nx">prelude</span><span class="p">.</span><span class="nx">fileExists</span> <span class="nx">content</span>
      <span class="nx">prelude</span><span class="p">.</span><span class="nx">readTextFile</span> <span class="nx">content</span>
    <span class="k">else</span>
      <span class="nx">content</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Store each server with an increasing portnumber</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">prelude</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span>
    <span class="p">(</span><span class="nx">require</span> <span class="s1">&#39;http&#39;</span><span class="p">).</span><span class="nx">createServer</span> <span class="nf">(req, res) -&gt;</span>
      <span class="nx">show</span> <span class="s2">&quot;#{req.client.remoteAddress} #{req.method} #{req.url}&quot;</span>
      <span class="k">if</span> <span class="nx">req</span><span class="p">.</span><span class="nx">method</span> <span class="o">is</span> <span class="s1">&#39;GET&#39;</span>
        <span class="k">if</span> <span class="nx">req</span><span class="p">.</span><span class="nx">url</span> <span class="o">is</span> <span class="s1">&#39;/&#39;</span>
          <span class="nx">res</span><span class="p">.</span><span class="nx">writeHead</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;text/html&#39;</span>
          <span class="nx">res</span><span class="p">.</span><span class="nx">write</span> <span class="nx">webpage</span>
          <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">()</span>
          <span class="k">return</span>
        <span class="k">else</span> <span class="k">if</span> <span class="nx">prelude</span><span class="p">.</span><span class="nx">fileExists</span> <span class="s2">&quot;..#{req.url.toString()}&quot;</span>
          <span class="k">if</span> <span class="nx">req</span><span class="p">.</span><span class="nx">url</span><span class="p">[</span><span class="mi">1</span><span class="p">..</span><span class="mi">3</span><span class="p">]</span> <span class="o">is</span> <span class="s1">&#39;img&#39;</span>
            <span class="nx">res</span><span class="p">.</span><span class="nx">writeHead</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;image/jpeg&#39;</span>
            <span class="nx">res</span><span class="p">.</span><span class="nx">write</span> <span class="nx">prelude</span><span class="p">.</span><span class="nx">readBinaryFile</span> <span class="s2">&quot;..#{req.url}&quot;</span>
            <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">()</span>
          <span class="k">return</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">writeHead</span> <span class="mi">404</span><span class="p">,</span> <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;text/html&#39;</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">write</span> <span class="s1">&#39;404 Not found&#39;</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">()</span>
  <span class="p">)</span>
  <span class="nv">lastServer = </span><span class="nx">prelude</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span>
  <span class="nx">prelude</span><span class="p">.</span><span class="nx">server</span><span class="p">[</span><span class="nx">lastServer</span><span class="p">].</span><span class="nx">listen</span> <span class="nx">prelude</span><span class="p">.</span><span class="nx">portNumber</span><span class="o">++</span>
  <span class="nx">viewURL</span> <span class="nx">prelude</span><span class="p">.</span><span class="nx">getServerURL</span> <span class="nx">prelude</span><span class="p">.</span><span class="nx">server</span><span class="p">[</span><span class="nx">lastServer</span><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>Stop a running view server</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude.stopServer = </span><span class="o">-&gt;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">lastServer = </span><span class="nx">prelude</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span>
    <span class="nx">prelude</span><span class="p">.</span><span class="nx">server</span><span class="p">[</span><span class="nx">lastServer</span><span class="p">].</span><span class="nx">close</span><span class="p">()</span>
    <span class="nx">prelude</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">length</span> <span class="o">-=</span> <span class="mi">1</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <h2>Interactive utilities</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>Display a data object to a given depth and optionally in colors </p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">util = </span><span class="nx">require</span> <span class="s1">&#39;util&#39;</span>
<span class="nv">prelude.show = </span><span class="nf">(obj, depth = 2, showHidden = false, colors = useColors) -&gt;</span>
  <span class="k">switch</span> <span class="k">typeof</span> <span class="nx">obj</span>
    <span class="k">when</span> <span class="s1">&#39;string&#39;</span> <span class="k">then</span> <span class="nx">util</span><span class="p">.</span><span class="nx">print</span> <span class="nx">obj</span><span class="p">,</span> <span class="s1">&#39;\n&#39;</span>
    <span class="k">when</span> <span class="s1">&#39;function&#39;</span> <span class="k">then</span> <span class="nx">util</span><span class="p">.</span><span class="nx">puts</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span>
    <span class="k">else</span> <span class="nx">util</span><span class="p">.</span><span class="nx">puts</span> <span class="nx">util</span><span class="p">.</span><span class="nx">inspect</span> <span class="nx">obj</span><span class="p">,</span> <span class="nx">showHidden</span><span class="p">,</span> <span class="nx">depth</span><span class="p">,</span> <span class="nx">colors</span>
  <span class="k">return</span> <span class="nx">obj</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>Ask a yes/no question - does not mix with the REPL</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude.confirm = </span><span class="nf">(message, resultFunction) -&gt;</span>
  <span class="nx">process</span><span class="p">.</span><span class="nx">stdin</span><span class="p">.</span><span class="nx">resume</span><span class="p">()</span>
  <span class="nx">process</span><span class="p">.</span><span class="nx">stdin</span><span class="p">.</span><span class="nx">setEncoding</span> <span class="s1">&#39;utf8&#39;</span>
  <span class="nx">show</span> <span class="nx">message</span> <span class="o">+</span> <span class="s1">&#39; (Y/n)&#39;</span>
  <span class="nx">process</span><span class="p">.</span><span class="nx">stdin</span><span class="p">.</span><span class="nx">once</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="nf">(answer) -&gt;</span>
    <span class="nx">process</span><span class="p">.</span><span class="nx">stdin</span><span class="p">.</span><span class="nx">pause</span><span class="p">()</span>
    <span class="nx">resultFunction</span> <span class="nx">answer</span> <span class="k">in</span> <span class="p">[</span><span class="s1">&#39;\n&#39;</span><span class="p">,</span><span class="s1">&#39;y\n&#39;</span><span class="p">,</span><span class="s1">&#39;Y\n&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span>
  <span class="kc">undefined</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>Ask a question with a string answer - does not mix with the REPL</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude.prompt = </span><span class="nf">(message, defaultAnswer, resultFunction) -&gt;</span>
  <span class="nx">process</span><span class="p">.</span><span class="nx">stdin</span><span class="p">.</span><span class="nx">resume</span><span class="p">()</span>
  <span class="nx">process</span><span class="p">.</span><span class="nx">stdin</span><span class="p">.</span><span class="nx">setEncoding</span> <span class="s1">&#39;utf8&#39;</span>
  <span class="nx">show</span> <span class="nx">message</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nx">defaultAnswer</span>
  <span class="nx">process</span><span class="p">.</span><span class="nx">stdin</span><span class="p">.</span><span class="nx">once</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="nf">(answer) -&gt;</span>
    <span class="nx">process</span><span class="p">.</span><span class="nx">stdin</span><span class="p">.</span><span class="nx">pause</span><span class="p">()</span>
    <span class="nx">resultFunction</span> <span class="k">if</span> <span class="nx">answer</span> <span class="o">is</span> <span class="s1">&#39;\n&#39;</span> <span class="k">then</span> <span class="nx">defaultAnswer</span> <span class="k">else</span> <span class="nx">answer</span><span class="p">.</span><span class="nx">trimRight</span><span class="p">()</span>
  <span class="kc">undefined</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>Import functions into the global namespace with globalize,
so that they do not need to be qualified each time.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude.globalize = </span><span class="nf">(ns, target = global) -&gt;</span>
  <span class="nx">target</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">ns</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="k">for</span> <span class="nx">name</span> <span class="k">of</span> <span class="nx">ns</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <h2>External libraries</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>Install underscore into <code>_</code> in the prelude</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude._ = </span><span class="nx">require</span> <span class="s1">&#39;./underscore&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>The REPL uses <code>_</code> for the last result so create
a synonym for <code>_</code> to help resolve conflicts.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude.underscore = </span><span class="nx">prelude</span><span class="p">.</span><span class="nx">_</span></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>Install coffeekup in the kup namespace</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude.kup = </span><span class="nx">require</span> <span class="s1">&#39;./coffeekup&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>Install websocket in the ws namespace</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude.ws = </span><span class="nx">require</span> <span class="s1">&#39;./ws&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>Install quickcheck in the qc namespace</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude.qc = </span><span class="nx">require</span> <span class="s1">&#39;./qc&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <h2>Additional test utilities</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>Node colored output for QuickCheck.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nx">NodeListener</span> <span class="k">extends</span> <span class="nx">prelude</span><span class="p">.</span><span class="nx">qc</span><span class="p">.</span><span class="nx">ConsoleListener</span>
  <span class="nv">constructor: </span><span class="nf">(@maxCollected = 10) -&gt;</span>
  <span class="nv">log: </span><span class="nf">(str) -&gt;</span> <span class="nx">show</span> <span class="nx">str</span>
  <span class="nv">passed: </span><span class="nf">(str) -&gt;</span> <span class="c1"># print message in green</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="k">if</span> <span class="nx">useColors</span> <span class="k">then</span> <span class="s2">&quot;\033[32m#{str}\033[0m&quot;</span> <span class="k">else</span> <span class="nx">str</span>
  <span class="nv">invalid: </span><span class="nf">(str) -&gt;</span> <span class="c1"># print message in yellow</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span> <span class="k">if</span> <span class="nx">useColors</span> <span class="k">then</span> <span class="s2">&quot;\033[33m#{str}\033[0m&quot;</span> <span class="k">else</span> <span class="nx">str</span>
  <span class="nv">failure: </span><span class="nf">(str) -&gt;</span> <span class="c1"># print message in red</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span> <span class="k">if</span> <span class="nx">useColors</span> <span class="k">then</span> <span class="s2">&quot;\033[31m#{str}\033[0m&quot;</span> <span class="k">else</span> <span class="nx">str</span>
  <span class="nv">done: </span><span class="o">-&gt;</span>
    <span class="nx">show</span> <span class="s1">&#39;Completed test.&#39;</span>
    <span class="nx">prelude</span><span class="p">.</span><span class="nx">qc</span><span class="p">.</span><span class="nx">resetProps</span><span class="p">()</span> <span class="c1"># Chain here if needed</span></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>Enhanced noteArg returning its argument
so it can be used inline.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude.qc.Case::note = </span><span class="nf">(a) -&gt;</span> <span class="nx">@noteArg</span> <span class="nx">a</span><span class="p">;</span> <span class="nx">a</span></pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p>Same as Case::note but also logs the noted args.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude.qc.Case::noteVerbose = </span><span class="nf">(a) -&gt;</span> <span class="nx">@noteArg</span> <span class="nx">a</span><span class="p">;</span> <span class="nx">show</span> <span class="nx">@args</span><span class="p">;</span> <span class="nx">a</span></pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <p>Helper to declare a named test property for
a function func taking types as arguments.
Property is passed the testcase, the arguments
and the result of calling func, it must return
a boolean indicating success or failure.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude.qc.testPure = </span><span class="nf">(func, types, name, property) -&gt;</span>
  <span class="nx">prelude</span><span class="p">.</span><span class="nx">qc</span><span class="p">.</span><span class="nx">declare</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">types</span><span class="p">,</span> <span class="nf">(c, a...) -&gt;</span>
    <span class="nx">c</span><span class="p">.</span><span class="nx">assert</span> <span class="nx">property</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">a</span><span class="p">...,</span> <span class="nx">c</span><span class="p">.</span><span class="nx">note</span> <span class="nx">func</span> <span class="nx">a</span><span class="p">...</span></pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p>Default qc configuration with 100 pass and 1000 invalid tests</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude.qcConfig = </span><span class="k">new</span> <span class="nx">prelude</span><span class="p">.</span><span class="nx">qc</span><span class="p">.</span><span class="nx">Config</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span></pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p>Test all known properties</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">prelude.qc.test = </span><span class="nf">(msg, func) -&gt;</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="p">[</span><span class="nx">msg</span><span class="p">,</span> <span class="nx">func</span><span class="p">,</span> <span class="nx">prelude</span><span class="p">.</span><span class="nx">qc</span><span class="p">.</span><span class="nx">runAllProps</span> <span class="nx">prelude</span><span class="p">.</span><span class="nx">qcConfig</span><span class="p">,</span> <span class="k">new</span> <span class="nx">NodeListener</span><span class="p">],</span>
    <span class="nf">(o) -&gt;</span> <span class="nx">unless</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isUndefined</span> <span class="nx">o</span> <span class="k">then</span> <span class="nx">show</span> <span class="nx">o</span></pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <h2>Shortcut to prelude definitions</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <p>See comment at definition of useGlobal</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">namespace = </span><span class="nx">global</span>
<span class="k">if</span> <span class="nx">useGlobal</span>
  <span class="nx">prelude</span><span class="p">.</span><span class="nx">globalize</span> <span class="nx">prelude</span><span class="p">,</span> <span class="nx">namespace</span></pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <p>Uncomment this to get underscore functions in global
prelude.globalize prelude.underscore, namespace</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">else</span>
  <span class="nv">namespace.prelude = </span><span class="nx">prelude</span></pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <p>In the REPL you can show definitions in the global
namespace with: <code>this.</code> followed by TAB.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 