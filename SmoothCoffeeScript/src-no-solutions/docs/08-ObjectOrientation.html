<!DOCTYPE html>  <html> <head>   <title>08-ObjectOrientation.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="00-Foreword.html">                 00-Foreword.coffee               </a>                                           <a class="source" href="01-Introduction.html">                 01-Introduction.coffee               </a>                                           <a class="source" href="02-BasicCoffeeScript.html">                 02-BasicCoffeeScript.coffee               </a>                                           <a class="source" href="03-Functions.html">                 03-Functions.coffee               </a>                                           <a class="source" href="04-DataStructures.html">                 04-DataStructures.coffee               </a>                                           <a class="source" href="04-emails.html">                 04-emails.coffee               </a>                                           <a class="source" href="05-ErrorHandling.html">                 05-ErrorHandling.coffee               </a>                                           <a class="source" href="06-FunctionalProgramming.html">                 06-FunctionalProgramming.coffee               </a>                                           <a class="source" href="07-Searching.html">                 07-Searching.coffee               </a>                                           <a class="source" href="08-ObjectOrientation.html">                 08-ObjectOrientation.coffee               </a>                                           <a class="source" href="09-RegularExpressions.html">                 09-RegularExpressions.coffee               </a>                                           <a class="source" href="10-Circular.html">                 10-Circular.coffee               </a>                                           <a class="source" href="10-CircularTest.html">                 10-CircularTest.coffee               </a>                                           <a class="source" href="10-MathFix.html">                 10-MathFix.coffee               </a>                                           <a class="source" href="10-Modularity.html">                 10-Modularity.coffee               </a>                                           <a class="source" href="10-SeedLife.html">                 10-SeedLife.coffee               </a>                                           <a class="source" href="10-TestWebSockets.html">                 10-TestWebSockets.coffee               </a>                                           <a class="source" href="10-WebSocketLife.html">                 10-WebSocketLife.coffee               </a>                                           <a class="source" href="A1-LanguageExtras.html">                 A1-LanguageExtras.coffee               </a>                                           <a class="source" href="A2-BinaryHeap.html">                 A2-BinaryHeap.coffee               </a>                                           <a class="source" href="A2-BinaryHeapTest.html">                 A2-BinaryHeapTest.coffee               </a>                                           <a class="source" href="A3-Microbench.html">                 A3-Microbench.coffee               </a>                                           <a class="source" href="A3-Microtest.html">                 A3-Microtest.py               </a>                                           <a class="source" href="A3-Queen.html">                 A3-Queen.coffee               </a>                                           <a class="source" href="A3-Queens.html">                 A3-Queens.py               </a>                                           <a class="source" href="A4-NoSolutions.html">                 A4-NoSolutions.coffee               </a>                                           <a class="source" href="coffeekup.html">                 coffeekup.coffee               </a>                                           <a class="source" href="prelude.html">                 prelude.coffee               </a>                                           <a class="source" href="underscore.html">                 underscore.coffee               </a>                                           <a class="source" href="ws.html">                 ws.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               08-ObjectOrientation.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="nx">require</span> <span class="s1">&#39;./prelude&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Bring underscore into global</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">globalize</span> <span class="nx">_</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Attach function</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">show</span> <span class="s1">&#39;--- Attach function ---&#39;</span>
<span class="nv">rabbit = </span><span class="p">{}</span>
<span class="nv">rabbit.speak = </span><span class="nf">(line) -&gt;</span>
  <span class="nx">show</span> <span class="s2">&quot;The rabbit says &#39;#{line}&#39;&quot;</span>
<span class="nx">rabbit</span><span class="p">.</span><span class="nx">speak</span> <span class="s2">&quot;Well, now you&#39;re asking me.&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Object programming</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">show</span> <span class="s1">&#39;--- Object programming ---&#39;</span>
<span class="nv">speak = </span><span class="nf">(line) -&gt;</span>
  <span class="nx">show</span> <span class="s2">&quot;The #{this.adjective} rabbit says &#39;#{line}&#39;&quot;</span>

<span class="nv">whiteRabbit = adjective: </span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="nv">speak: </span><span class="nx">speak</span>
<span class="nv">fatRabbit = adjective: </span><span class="s2">&quot;fat&quot;</span><span class="p">,</span> <span class="nv">speak: </span><span class="nx">speak</span>

<span class="nx">whiteRabbit</span><span class="p">.</span><span class="nx">speak</span> <span class="s2">&quot;Oh my ears and whiskers, &quot;</span> <span class="o">+</span>
                  <span class="s2">&quot;how late it&#39;s getting!&quot;</span>
<span class="nx">fatRabbit</span><span class="p">.</span><span class="nx">speak</span> <span class="s2">&quot;I could sure use a carrot right now.&quot;</span>

<span class="nx">speak</span><span class="p">.</span><span class="nx">apply</span> <span class="nx">fatRabbit</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Yum.&#39;</span><span class="p">]</span>
<span class="nx">speak</span><span class="p">.</span><span class="nx">call</span> <span class="nx">fatRabbit</span><span class="p">,</span> <span class="s1">&#39;Burp.&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Class concept</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">show</span> <span class="s1">&#39;--- Class concept ---&#39;</span>
<span class="k">class</span> <span class="nx">Rabbit</span>
  <span class="nv">constructor: </span><span class="nf">(@adjective) -&gt;</span>
  <span class="nv">speak: </span><span class="nf">(line) -&gt;</span>
    <span class="nx">show</span> <span class="s2">&quot;The #{@adjective} rabbit says &#39;#{line}&#39;&quot;</span>

<span class="nv">whiteRabbit = </span><span class="k">new</span> <span class="nx">Rabbit</span> <span class="s2">&quot;white&quot;</span>
<span class="nv">fatRabbit = </span><span class="k">new</span> <span class="nx">Rabbit</span> <span class="s2">&quot;fat&quot;</span>

<span class="nx">whiteRabbit</span><span class="p">.</span><span class="nx">speak</span> <span class="s2">&quot;Hurry!&quot;</span>
<span class="nx">fatRabbit</span><span class="p">.</span><span class="nx">speak</span> <span class="s2">&quot;Tasty!&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>New constructor</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">show</span> <span class="s1">&#39;--- New constructor ---&#39;</span>
<span class="nv">killerRabbit = </span><span class="k">new</span> <span class="nx">Rabbit</span> <span class="s1">&#39;killer&#39;</span>
<span class="nx">killerRabbit</span><span class="p">.</span><span class="nx">speak</span> <span class="s1">&#39;GRAAAAAAAAAH!&#39;</span>
<span class="nx">show</span> <span class="nx">killerRabbit</span>

<span class="nv">makeRabbit = </span><span class="nf">(adjective) -&gt;</span>
  <span class="nv">adjective: </span><span class="nx">adjective</span>
  <span class="nv">speak: </span><span class="nf">(line) -&gt;</span> <span class="nx">show</span> <span class="nx">adjective</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="nx">line</span>
<span class="nv">blackRabbit = </span><span class="nx">makeRabbit</span> <span class="s1">&#39;black&#39;</span>

<span class="nx">show</span> <span class="nx">killerRabbit</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">name</span>
<span class="nx">show</span> <span class="nx">blackRabbit</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">name</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Extends keyword</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">show</span> <span class="s1">&#39;--- Extends keyword ---&#39;</span>
<span class="k">class</span> <span class="nx">WeightyRabbit</span> <span class="k">extends</span> <span class="nx">Rabbit</span>
  <span class="nv">constructor: </span><span class="nf">(adjective, @weight) -&gt;</span>
    <span class="k">super</span> <span class="nx">adjective</span>
  <span class="nv">adjustedWeight: </span><span class="nf">(relativeGravity) -&gt;</span>
    <span class="p">(</span><span class="nx">@weight</span> <span class="o">*</span> <span class="nx">relativeGravity</span><span class="p">).</span><span class="nx">toPrecision</span> <span class="mi">2</span>

<span class="nv">tinyRabbit = </span><span class="k">new</span> <span class="nx">WeightyRabbit</span> <span class="s2">&quot;tiny&quot;</span><span class="p">,</span> <span class="mf">1.01</span>
<span class="nv">jumboRabbit = </span><span class="k">new</span> <span class="nx">WeightyRabbit</span> <span class="s2">&quot;jumbo&quot;</span><span class="p">,</span> <span class="mf">7.47</span>

<span class="nv">moonGravity = </span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span>
<span class="nx">jumboRabbit</span><span class="p">.</span><span class="nx">speak</span> <span class="s2">&quot;Carry me, I weigh #{jumboRabbit.adjustedWeight(moonGravity)} stones&quot;</span>
<span class="nx">tinyRabbit</span><span class="p">.</span><span class="nx">speak</span> <span class="s2">&quot;He ain&#39;t heavy, he is my brother&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Inheritance pitfalls</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">show</span> <span class="s1">&#39;--- Inheritance pitfalls ---&#39;</span>
<span class="k">class</span> <span class="nx">Account</span>
  <span class="nv">constructor: </span><span class="o">-&gt;</span> <span class="vi">@balance = </span><span class="mi">0</span>
  <span class="nv">transfer: </span><span class="nf">(amount) -&gt;</span> <span class="nx">@balance</span> <span class="o">+=</span> <span class="nx">amount</span>
  <span class="nv">getBalance: </span><span class="o">-&gt;</span> <span class="nx">@balance</span>
  <span class="nv">batchTransfer: </span><span class="nf">(amtList) -&gt;</span>
    <span class="k">for</span> <span class="nx">amount</span> <span class="k">in</span> <span class="nx">amtList</span>
      <span class="nx">@transfer</span> <span class="nx">amount</span>

<span class="nv">yourAccount = </span><span class="k">new</span> <span class="nx">Account</span><span class="p">()</span>
<span class="nv">oldBalance = </span><span class="nx">yourAccount</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()</span>
<span class="nx">yourAccount</span><span class="p">.</span><span class="nx">transfer</span> <span class="nv">salary = </span><span class="mi">1000</span>
<span class="nv">newBalance = </span><span class="nx">yourAccount</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()</span>
<span class="nx">show</span> <span class="s2">&quot;Books balance: #{salary == newBalance - oldBalance}.&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Violation of substitution property</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">show</span> <span class="s1">&#39;--- Violation of substitution property ---&#39;</span>
<span class="k">class</span> <span class="nx">AccountWithFee</span> <span class="k">extends</span> <span class="nx">Account</span>
  <span class="nv">fee: </span><span class="mi">5</span>
  <span class="nv">transfer: </span><span class="nf">(amount) -&gt;</span>
    <span class="k">super</span> <span class="nx">amount</span> <span class="o">-</span> <span class="nx">@fee</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>feeAccount.transfer @fee</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">yourAccount = </span><span class="k">new</span> <span class="nx">AccountWithFee</span><span class="p">()</span>
<span class="nv">oldBalance = </span><span class="nx">yourAccount</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()</span>
<span class="nx">yourAccount</span><span class="p">.</span><span class="nx">transfer</span> <span class="nv">salary = </span><span class="mi">1000</span>
<span class="nv">newBalance = </span><span class="nx">yourAccount</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()</span>
<span class="nx">show</span> <span class="s2">&quot;Books balance: #{salary == newBalance - oldBalance}.&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Limited account class</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">show</span> <span class="s1">&#39;--- Limited account class ---&#39;</span>
<span class="k">class</span> <span class="nx">LimitedAccount</span> <span class="k">extends</span> <span class="nx">Account</span>
  <span class="nv">constructor: </span><span class="o">-&gt;</span> <span class="k">super</span><span class="p">;</span> <span class="nx">@resetLimit</span><span class="p">()</span>
  <span class="nv">resetLimit: </span><span class="o">-&gt;</span> <span class="vi">@dailyLimit = </span><span class="mi">50</span>
  <span class="nv">transfer: </span><span class="nf">(amount) -&gt;</span>
    <span class="k">if</span> <span class="nx">amount</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">and</span> <span class="p">(</span><span class="nx">@dailyLimit</span> <span class="o">+=</span> <span class="nx">amount</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span> <span class="s2">&quot;You maxed out!&quot;</span>
    <span class="k">else</span>
      <span class="k">super</span> <span class="nx">amount</span>
<span class="nv">lacc = </span><span class="k">new</span> <span class="nx">LimitedAccount</span><span class="p">()</span>
<span class="nx">lacc</span><span class="p">.</span><span class="nx">transfer</span> <span class="mi">50</span>
<span class="nx">show</span> <span class="s2">&quot;Start balance #{lacc.getBalance()}&quot;</span>

<span class="k">try</span> <span class="nx">lacc</span><span class="p">.</span><span class="nx">batchTransfer</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">..</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span>
<span class="k">catch</span> <span class="nx">error</span> <span class="k">then</span> <span class="nx">show</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span>
<span class="nx">show</span> <span class="s2">&quot;After batch balance #{lacc.getBalance()}&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Fragile base class</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">show</span> <span class="s1">&#39;--- Fragile base class ---&#39;</span>
<span class="k">class</span> <span class="nx">Account</span>
  <span class="nv">constructor: </span><span class="o">-&gt;</span> <span class="vi">@balance = </span><span class="mi">0</span>
  <span class="nv">transfer: </span><span class="nf">(amount) -&gt;</span> <span class="nx">@balance</span> <span class="o">+=</span> <span class="nx">amount</span>
  <span class="nv">getBalance: </span><span class="o">-&gt;</span> <span class="nx">@balance</span>
  <span class="nv">batchTransfer: </span><span class="nf">(amtList) -&gt;</span>
    <span class="nv">add = </span><span class="nf">(a,b) -&gt;</span> <span class="nx">a</span><span class="o">+</span><span class="nx">b</span>
    <span class="nv">sum = </span><span class="nf">(list) -&gt;</span> <span class="nx">reduce</span> <span class="nx">list</span><span class="p">,</span> <span class="nx">add</span><span class="p">,</span> <span class="mi">0</span>
    <span class="nx">@balance</span> <span class="o">+=</span> <span class="nx">sum</span> <span class="nx">amtList</span>

<span class="k">class</span> <span class="nx">LimitedAccount</span> <span class="k">extends</span> <span class="nx">Account</span>
  <span class="nv">constructor: </span><span class="o">-&gt;</span> <span class="k">super</span><span class="p">;</span> <span class="nx">@resetLimit</span><span class="p">()</span>
  <span class="nv">resetLimit: </span><span class="o">-&gt;</span> <span class="vi">@dailyLimit = </span><span class="mi">50</span>
  <span class="nv">transfer: </span><span class="nf">(amount) -&gt;</span>
    <span class="k">if</span> <span class="nx">amount</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">and</span> <span class="p">(</span><span class="nx">@dailyLimit</span> <span class="o">+=</span> <span class="nx">amount</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span> <span class="s2">&quot;You maxed out!&quot;</span>
    <span class="k">else</span>
      <span class="k">super</span> <span class="nx">amount</span>

<span class="nv">lacc = </span><span class="k">new</span> <span class="nx">LimitedAccount</span><span class="p">()</span>
<span class="nx">lacc</span><span class="p">.</span><span class="nx">transfer</span> <span class="mi">50</span>
<span class="nx">show</span> <span class="s2">&quot;Starting with #{lacc.getBalance()}&quot;</span>

<span class="k">try</span> <span class="nx">lacc</span><span class="p">.</span><span class="nx">batchTransfer</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">..</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span>
<span class="k">catch</span> <span class="nx">error</span> <span class="k">then</span> <span class="nx">show</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span>
<span class="nx">show</span> <span class="s2">&quot;After batch balance #{lacc.getBalance()}&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Prototypes</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">show</span> <span class="s1">&#39;--- Prototypes ---&#39;</span>
<span class="nv">simpleObject = </span><span class="p">{}</span>
<span class="nx">show</span> <span class="nx">simpleObject</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">name</span>
<span class="nx">show</span> <span class="nx">simpleObject</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span>

<span class="nx">show</span> <span class="nx">Rabbit</span><span class="p">.</span><span class="nx">prototype</span>
<span class="nx">show</span> <span class="nx">Rabbit</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">name</span>
<span class="nx">Rabbit</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">speak</span> <span class="s1">&#39;I am generic&#39;</span>
<span class="nx">Rabbit</span><span class="o">::</span><span class="nx">speak</span> <span class="s1">&#39;I am not initialized&#39;</span>

<span class="nx">show</span> <span class="nx">killerRabbit</span><span class="p">.</span><span class="nx">toString</span> <span class="o">==</span> <span class="nx">simpleObject</span><span class="p">.</span><span class="nx">toString</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Shared properties</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">show</span> <span class="s1">&#39;--- Shared properties ---&#39;</span>
<span class="nv">Rabbit::teeth = </span><span class="s1">&#39;small&#39;</span>
<span class="nx">show</span> <span class="nx">killerRabbit</span><span class="p">.</span><span class="nx">teeth</span>
<span class="nv">killerRabbit.teeth = </span><span class="s1">&#39;long, sharp, and bloody&#39;</span>
<span class="nx">show</span> <span class="nx">killerRabbit</span><span class="p">.</span><span class="nx">teeth</span>
<span class="nx">show</span> <span class="nx">Rabbit</span><span class="o">::</span><span class="nx">teeth</span>

<span class="nv">Rabbit::dance = </span><span class="o">-&gt;</span>
  <span class="nx">show</span> <span class="s2">&quot;The #{@adjective} rabbit dances a jig.&quot;</span>
<span class="nx">killerRabbit</span><span class="p">.</span><span class="nx">dance</span><span class="p">()</span>

<span class="nv">Rabbit = </span><span class="nf">(adjective) -&gt;</span>
  <span class="vi">@adjective = </span><span class="nx">adjective</span>

<span class="nv">Rabbit::speak = </span><span class="nf">(line) -&gt;</span>
  <span class="nx">show</span> <span class="s2">&quot;The #{@adjective} rabbit says &#39;#{line}&#39;&quot;</span>

<span class="nv">hazelRabbit = </span><span class="k">new</span> <span class="nx">Rabbit</span> <span class="s2">&quot;hazel&quot;</span>
<span class="nx">hazelRabbit</span><span class="p">.</span><span class="nx">speak</span> <span class="s2">&quot;Good Frith!&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Exposed properties</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">show</span> <span class="s1">&#39;--- Exposed properties ---&#39;</span>
<span class="nv">noCatsAtAll = </span><span class="p">{}</span>
<span class="k">if</span> <span class="s2">&quot;constructor&quot;</span> <span class="k">of</span> <span class="nx">noCatsAtAll</span>
  <span class="nx">show</span> <span class="s2">&quot;Yes, there is a cat called &#39;constructor&#39;.&quot;</span>

<span class="nb">Object</span><span class="o">::</span><span class="nv">allProperties = </span><span class="o">-&gt;</span>
  <span class="k">for</span> <span class="nx">property</span> <span class="k">of</span> <span class="k">this</span>
    <span class="nx">property</span>

<span class="nv">test = x: </span><span class="mi">10</span><span class="p">,</span> <span class="nv">y: </span><span class="mi">3</span>
<span class="nx">show</span> <span class="nx">test</span><span class="p">.</span><span class="nx">allProperties</span><span class="p">()</span>

<span class="nb">Object</span><span class="o">::</span><span class="nv">ownProperties = </span><span class="o">-&gt;</span>
  <span class="k">for</span> <span class="nx">own</span> <span class="nx">property</span> <span class="k">of</span> <span class="err">@</span>
    <span class="nx">property</span>

<span class="nv">test = </span><span class="s1">&#39;Fat Igor&#39;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="s1">&#39;Fireball&#39;</span><span class="o">:</span> <span class="kc">true</span>
<span class="nx">show</span> <span class="nx">test</span><span class="p">.</span><span class="nx">ownProperties</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Function forEachOf</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">show</span> <span class="s1">&#39;--- Function forEachOf ---&#39;</span>
<span class="nv">forEachOf = </span><span class="nf">(object, action) -&gt;</span>
  <span class="k">for</span> <span class="nx">own</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span> <span class="k">of</span> <span class="nx">object</span>
    <span class="nx">action</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span>

<span class="nv">chimera = head: </span><span class="s2">&quot;lion&quot;</span><span class="p">,</span> <span class="nv">body: </span><span class="s2">&quot;goat&quot;</span><span class="p">,</span> <span class="nv">tail: </span><span class="s2">&quot;snake&quot;</span>
<span class="nx">forEachOf</span> <span class="nx">chimera</span><span class="p">,</span> <span class="nf">(name, value) -&gt;</span>
  <span class="nx">show</span> <span class="s2">&quot;The #{name} of a #{value}.&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>Object methods</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">show</span> <span class="s1">&#39;--- Object methods ---&#39;</span>
<span class="nv">forEachIn = </span><span class="nf">(object, action) -&gt;</span>
  <span class="k">for</span> <span class="nx">property</span> <span class="k">of</span> <span class="nx">object</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Object</span><span class="o">::</span><span class="nx">hasOwnProperty</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">object</span><span class="p">,</span> <span class="nx">property</span><span class="p">))</span>
      <span class="nx">action</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">object</span><span class="p">[</span><span class="nx">property</span><span class="p">]</span>

<span class="nv">test = name: </span><span class="s2">&quot;Mordecai&quot;</span><span class="p">,</span> <span class="nv">hasOwnProperty: </span><span class="s2">&quot;Uh-oh&quot;</span>
<span class="nx">forEachIn</span> <span class="nx">test</span><span class="p">,</span> <span class="nf">(name, value) -&gt;</span>
  <span class="nx">show</span> <span class="s2">&quot;Property #{name} = #{value}&quot;</span>

<span class="k">for</span> <span class="nx">own</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span> <span class="k">of</span> <span class="nx">test</span>
  <span class="nx">show</span> <span class="s2">&quot;Property #{property} = #{value}&quot;</span>

<span class="nv">obj = foo: </span><span class="s1">&#39;bar&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>This test is needed to avoid hidden properties ...</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">show</span> <span class="nb">Object</span><span class="o">::</span><span class="nx">hasOwnProperty</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">)</span> <span class="o">and</span>
     <span class="nb">Object</span><span class="o">::</span><span class="nx">propertyIsEnumerable</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>... because this returns true ...</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">show</span> <span class="nb">Object</span><span class="o">::</span><span class="nx">hasOwnProperty</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="s1">&#39;__proto__&#39;</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>... this is required to get false.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">show</span> <span class="nb">Object</span><span class="o">::</span><span class="nx">hasOwnProperty</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="s1">&#39;__proto__&#39;</span><span class="p">)</span> <span class="o">and</span>
     <span class="nb">Object</span><span class="o">::</span><span class="nx">propertyIsEnumerable</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="s1">&#39;__proto__&#39;</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Dictionary</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">show</span> <span class="s1">&#39;--- Dictionary ---&#39;</span>
<span class="k">class</span> <span class="nx">Dictionary</span>
  <span class="nv">constructor: </span><span class="nf">(@values = {}) -&gt;</span>

  <span class="nv">store: </span><span class="nf">(name, value) -&gt;</span>
    <span class="nx">@values</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span>

  <span class="nv">lookup: </span><span class="nf">(name) -&gt;</span>
    <span class="nx">@values</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span>

  <span class="nv">contains: </span><span class="nf">(name) -&gt;</span>
    <span class="nb">Object</span><span class="o">::</span><span class="nx">hasOwnProperty</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">@values</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="o">and</span>
    <span class="nb">Object</span><span class="o">::</span><span class="nx">propertyIsEnumerable</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">@values</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span>

  <span class="nv">each: </span><span class="nf">(action) -&gt;</span>
    <span class="k">for</span> <span class="nx">own</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span> <span class="k">of</span> <span class="nx">@values</span>
      <span class="nx">action</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span>

<span class="nv">colours = </span><span class="k">new</span> <span class="nx">Dictionary</span>
  <span class="nv">Grover: </span><span class="s1">&#39;blue&#39;</span>
  <span class="nv">Elmo: </span>  <span class="s1">&#39;orange&#39;</span>
  <span class="nv">Bert: </span>  <span class="s1">&#39;yellow&#39;</span>

<span class="nx">show</span> <span class="nx">colours</span><span class="p">.</span><span class="nx">contains</span> <span class="s1">&#39;Grover&#39;</span>
<span class="nx">colours</span><span class="p">.</span><span class="nx">each</span> <span class="nf">(name, colour) -&gt;</span>
  <span class="nx">show</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39; is &#39;</span> <span class="o">+</span> <span class="nx">colour</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 