<!DOCTYPE html>
<html>
  <head>
    <title>ontouchstart.github.com</title>
    <style>
    </style>
    <script type="text/javascript">
      function css(rule) {
        document.styleSheets[0].insertRule(rule);
      }

      function el(parent, tag) {
        var _el = document.createElement(tag);
        parent.appendChild(_el);
        return _el;
      }
      
      function resetCSS() {
        css(" * { -webkit-touch-callout:none; }");
        css(" * { -webkit-user-select:none; }");
        css(" * { -webkit-text-size-adjust:none; }");
        css(" * { -webkit-tap-highlight-color: transparent;}");
      }
      
      function lockDocument() {
        document.addEventListener('touchmove', function (e) {
           e.preventDefault();
        })
      }
      
      function holdToChange(el, text) {
        var old = el.innerHTML;
        el.ontouchstart = function () { 
          this.innerHTML = text;
        }
        el.ontouchend = function () { 
          this.innerHTML = old;
        }
      }

      function touchMoveToSpin(sensor, element, d, xmin, xmax) {
        var spinClassArray = new Array(n);
        var angle = -180;
        var n = xmax - xmin;
        for(var i = 0; i < n; i++){
          css('.spin-' + i + ' { -webkit-transform: rotateY(' + angle + 'deg);}');
          angle += d;
        } 
        var oldClass = el.className;

        sensor.ontouchstart = function () { 
          sensor.ontouchmove = function (e) {
            var x = e.touches[0].pageX;
            if( x < xmin) return;
            if( x > xmax) return;
            element.className = oldClass + ' spin-' + (x - xmin);
          };
        }
      }

      window.addEventListener('load', function() {
        lockDocument();
        resetCSS();
        css(" h1 { width: 100%; text-align: center; }");
        var helloWorld = el(document.body, 'h1');
        helloWorld.innerHTML = 'Hello World';
        holdToChange(helloWorld, 'Hello World from ontouchstart');
        var w = document.body.scrollWidth;
        touchMoveToSpin(document, helloWorld, 360/w, 0, w);
      });
    </script>
  </head>
  <body>
  </body>
</html>
